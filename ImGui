local ImGui = {
	Animations = {
		Buttons = {
			MouseEnter = { BackgroundTransparency = 0.5 },
			MouseLeave = { BackgroundTransparency = 0.7 }
		},
		Tabs = {
			MouseEnter = { BackgroundTransparency = 0.5 },
			MouseLeave = { BackgroundTransparency = 1 }
		}
	},
	Windows = {},
	Animation = TweenInfo.new(0.1),
	ThemeManager = {},
	SaveManager = {},
	IsMobile = false
}

local NullFunction = function() end
local CloneRef = cloneref or function(_) return _ end
local function GetService(...) return CloneRef(game:GetService(...)) end

local TweenService = GetService("TweenService")
local UserInputService = GetService("UserInputService")
local Players = GetService("Players")
local CoreGui = GetService("CoreGui")
local RunService = GetService("RunService")
local HttpService = GetService("HttpService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer.PlayerGui
local Mouse = LocalPlayer:GetMouse()

local IsStudio = RunService:IsStudio()

ImGui.IsMobile = UserInputService.TouchEnabled and not UserInputService.MouseEnabled

function ImGui:CreateInstance(Class, Parent, Properties)
	local Instance = Instance.new(Class)
	for Key, Value in pairs(Properties or {}) do
		Instance[Key] = Value
	end
	Instance.Parent = Parent
	return Instance
end

function ImGui:Tween(Instance, Properties, TweenInfoOverride)
	local TweenInfo = TweenInfoOverride or self.Animation
	local Tween = TweenService:Create(Instance, TweenInfo, Properties)
	Tween:Play()
	return Tween
end

function ImGui:ApplyAnimations(GuiObject, AnimationType)
	local Animations = self.Animations[AnimationType]
	if not Animations then return end
	
	GuiObject.MouseEnter:Connect(function()
		self:Tween(GuiObject, Animations.MouseEnter)
	end)
	
	GuiObject.MouseLeave:Connect(function()
		self:Tween(GuiObject, Animations.MouseLeave)
	end)
end

function ImGui:ApplyDraggable(Frame)
	local Dragging = false
	local DragInput, MousePos, FramePos
	
	Frame.InputBegan:Connect(function(Input)
		if Input.UserInputType == Enum.UserInputType.MouseButton1 or Input.UserInputType == Enum.UserInputType.Touch then
			Dragging = true
			MousePos = Input.Position
			FramePos = Frame.Position
			
			Input.Changed:Connect(function()
				if Input.UserInputState == Enum.UserInputState.End then
					Dragging = false
				end
			end)
		end
	end)
	
	Frame.InputChanged:Connect(function(Input)
		if Input.UserInputType == Enum.UserInputType.MouseMovement or Input.UserInputType == Enum.UserInputType.Touch then
			DragInput = Input
		end
	end)
	
	UserInputService.InputChanged:Connect(function(Input)
		if Input == DragInput and Dragging then
			local Delta = Input.Position - MousePos
			Frame.Position = UDim2.new(
				FramePos.X.Scale,
				FramePos.X.Offset + Delta.X,
				FramePos.Y.Scale,
				FramePos.Y.Offset + Delta.Y
			)
		end
	end)
end

function ImGui:AddTooltip(GuiObject, TooltipText)
	if not TooltipText or TooltipText == "" or ImGui.IsMobile then return end
	
	local Tooltip = Instance.new("TextLabel")
	Tooltip.Name = "Tooltip"
	Tooltip.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	Tooltip.BorderColor3 = Color3.fromRGB(40, 40, 40)
	Tooltip.BorderSizePixel = 1
	Tooltip.Font = Enum.Font.Code
	Tooltip.TextColor3 = Color3.fromRGB(255, 255, 255)
	Tooltip.TextSize = 12
	Tooltip.Text = TooltipText
	Tooltip.TextWrapped = true
	Tooltip.AutomaticSize = Enum.AutomaticSize.XY
	Tooltip.Visible = false
	Tooltip.ZIndex = 10000
	Tooltip.Parent = ImGui.ScreenGui
	
	local Padding = Instance.new("UIPadding", Tooltip)
	Padding.PaddingLeft = UDim.new(0, 6)
	Padding.PaddingRight = UDim.new(0, 6)
	Padding.PaddingTop = UDim.new(0, 4)
	Padding.PaddingBottom = UDim.new(0, 4)
	
	GuiObject.MouseEnter:Connect(function()
		Tooltip.Visible = true
	end)
	
	GuiObject.MouseLeave:Connect(function()
		Tooltip.Visible = false
	end)
	
	GuiObject.MouseMoved:Connect(function()
		if Tooltip.Visible then
			local MousePos = UserInputService:GetMouseLocation()
			Tooltip.Position = UDim2.fromOffset(MousePos.X + 10, MousePos.Y + 10)
		end
	end)
	
	return Tooltip
end

function ImGui:ContainerClass(Frame, Class, Window)
	local ContainerClass = Class or {}
	local WindowConfig = ImGui.Windows[Window]
	
	function ContainerClass:AddLabel(Config)
		Config = Config or {}
		
		local Holder = self:CreateInstance("Frame", Frame, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 20)
		})
		
		local Label = self:CreateInstance("TextLabel", Holder, {
			BackgroundTransparency = 1,
			Size = UDim2.fromScale(1, 1),
			Font = Enum.Font.Code,
			Text = Config.Text or "Label",
			TextColor3 = Config.TextColor or Color3.fromRGB(255, 255, 255),
			TextSize = Config.Size or 13,
			TextWrapped = Config.DoesWrap or false,
			TextXAlignment = Enum.TextXAlignment.Left
		})
		
		if Config.DoesWrap then
			Label.AutomaticSize = Enum.AutomaticSize.Y
			Holder.AutomaticSize = Enum.AutomaticSize.Y
		end
		
		function Config:SetText(Text)
			Label.Text = Text
			return Config
		end
		
		function Config:SetColor(Color)
			Label.TextColor3 = Color
			return Config
		end
		
		return Config
	end
	
	function ContainerClass:AddParagraph(Config)
		Config = Config or {}
		Config.DoesWrap = true
		Config.Size = Config.Size or 12
		return self:AddLabel(Config)
	end
	
	function ContainerClass:AddSubtitle(Config)
		Config = Config or {}
		Config.Size = Config.Size or 15
		local Label = self:AddLabel(Config)
		return Label
	end
	
	function ContainerClass:AddDivider()
		self:CreateInstance("Frame", Frame, {
			BackgroundColor3 = Color3.fromRGB(40, 40, 40),
			BorderSizePixel = 0,
			Size = UDim2.new(1, 0, 0, 1)
		})
	end
	
	function ContainerClass:AddButton(Config)
		Config = Config or {}
		
		local Holder = self:CreateInstance("Frame", Frame, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 28)
		})
		
		local Button = self:CreateInstance("TextButton", Holder, {
			BackgroundColor3 = Color3.fromRGB(35, 35, 35),
			BorderColor3 = Color3.fromRGB(40, 40, 40),
			BorderSizePixel = 1,
			Size = UDim2.fromScale(1, 1),
			Font = Enum.Font.Code,
			Text = Config.Text or "Button",
			TextColor3 = Config.Risky and Color3.fromRGB(255, 50, 50) or Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			TextTransparency = 0.4,
			Active = not (Config.Disabled or false)
		})
		
		self:CreateInstance("UICorner", Button, {
			CornerRadius = UDim.new(0, 4)
		})
		
		Config.Callback = Config.Callback or NullFunction
		Config.Locked = false
		
		Button.Activated:Connect(function()
			if Config.Disabled or Config.Locked then return end
			
			if Config.DoubleClick then
				Config.Locked = true
				local OriginalText = Button.Text
				Button.Text = "Sure?"
				Button.TextColor3 = Color3.fromRGB(125, 85, 255)
				
				task.delay(0.5, function()
					if Config.Locked then
						Button.Text = OriginalText
						Button.TextColor3 = Config.Risky and Color3.fromRGB(255, 50, 50) or Color3.fromRGB(255, 255, 255)
						Config.Locked = false
					end
				end)
				
				return
			end
			
			Config.Callback()
		end)
		
		function Config:SetText(Text)
			Button.Text = Text
			return Config
		end
		
		function Config:SetDisabled(Disabled)
			Config.Disabled = Disabled
			Button.Active = not Disabled
			Button.BackgroundColor3 = Disabled and Color3.fromRGB(20, 20, 20) or Color3.fromRGB(35, 35, 35)
			Button.TextTransparency = Disabled and 0.8 or 0.4
			return Config
		end
		
		function Config:AddButton(SubConfig)
			SubConfig = SubConfig or {}
			
			Button.Size = UDim2.new(0.48, 0, 1, 0)
			
			local Layout = self:CreateInstance("UIListLayout", Holder, {
				FillDirection = Enum.FillDirection.Horizontal,
				HorizontalAlignment = Enum.HorizontalAlignment.SpaceBetween,
				Padding = UDim.new(0, 4)
			})
			
			local SubButton = self:CreateInstance("TextButton", Holder, {
				BackgroundColor3 = Color3.fromRGB(35, 35, 35),
				BorderColor3 = Color3.fromRGB(40, 40, 40),
				BorderSizePixel = 1,
				Size = UDim2.new(0.48, 0, 1, 0),
				Font = Enum.Font.Code,
				Text = SubConfig.Text or "Sub",
				TextColor3 = SubConfig.Risky and Color3.fromRGB(255, 50, 50) or Color3.fromRGB(255, 255, 255),
				TextSize = 13,
				TextTransparency = 0.4
			})
			
			self:CreateInstance("UICorner", SubButton, {
				CornerRadius = UDim.new(0, 4)
			})
			
			SubConfig.Callback = SubConfig.Callback or NullFunction
			SubButton.Activated:Connect(SubConfig.Callback)
			
			ImGui:ApplyAnimations(SubButton, "Buttons")
			return SubConfig
		end
		
		ImGui:ApplyAnimations(Button, "Buttons")
		
		if Config.Tooltip then
			ImGui:AddTooltip(Button, Config.Tooltip)
		end
		
		return Config
	end
	
	function ContainerClass:AddToggle(Config)
		Config = Config or {}
		
		local Holder = self:CreateInstance("Frame", Frame, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 20)
		})
		
		local Button = self:CreateInstance("TextButton", Holder, {
			BackgroundTransparency = 1,
			Size = UDim2.fromScale(1, 1),
			Text = ""
		})
		
		local CheckFrame = self:CreateInstance("Frame", Button, {
			BackgroundColor3 = Color3.fromRGB(35, 35, 35),
			BorderColor3 = Color3.fromRGB(40, 40, 40),
			BorderSizePixel = 1,
			Size = UDim2.fromOffset(16, 16),
			Position = UDim2.fromOffset(0, 2)
		})
		
		self:CreateInstance("UICorner", CheckFrame, {
			CornerRadius = UDim.new(0, 2)
		})
		
		local Indicator = self:CreateInstance("Frame", CheckFrame, {
			BackgroundColor3 = Color3.fromRGB(125, 85, 255),
			BorderSizePixel = 0,
			Size = UDim2.new(1, -4, 1, -4),
			Position = UDim2.fromOffset(2, 2),
			BackgroundTransparency = 1
		})
		
		self:CreateInstance("UICorner", Indicator, {
			CornerRadius = UDim.new(0, 1)
		})
		
		local Label = self:CreateInstance("TextLabel", Button, {
			BackgroundTransparency = 1,
			Position = UDim2.fromOffset(22, 0),
			Size = UDim2.new(1, -22, 1, 0),
			Font = Enum.Font.Code,
			Text = Config.Text or "Toggle",
			TextColor3 = Config.Risky and Color3.fromRGB(255, 50, 50) or Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			TextTransparency = 0.4,
			TextXAlignment = Enum.TextXAlignment.Left
		})
		
		Config.Value = Config.Default or false
		Config.Callback = Config.Callback or NullFunction
		
		local function UpdateToggle(Value)
			Config.Value = Value
			ImGui:Tween(Indicator, { BackgroundTransparency = Value and 0 or 1 })
			ImGui:Tween(Label, { TextTransparency = Value and 0 or 0.4 })
			if not Config.Disabled then
				Config.Callback(Value)
			end
		end
		
		Button.Activated:Connect(function()
			if Config.Disabled then return end
			UpdateToggle(not Config.Value)
		end)
		
		function Config:SetValue(Value)
			UpdateToggle(Value)
			return Config
		end
		
		function Config:SetDisabled(Disabled)
			Config.Disabled = Disabled
			Button.Active = not Disabled
			return Config
		end
		
		UpdateToggle(Config.Value)
		
		if Config.Tooltip then
			ImGui:AddTooltip(Button, Config.Tooltip)
		end
		
		return Config
	end
	
	function ContainerClass:AddSlider(Config)
		Config = Config or {}
		
		local Holder = self:CreateInstance("Frame", Frame, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 40)
		})
		
		local Label = self:CreateInstance("TextLabel", Holder, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, -60, 0, 18),
			Font = Enum.Font.Code,
			Text = Config.Text or "Slider",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			TextTransparency = 0.4,
			TextXAlignment = Enum.TextXAlignment.Left
		})
		
		local ValueLabel = self:CreateInstance("TextLabel", Holder, {
			BackgroundTransparency = 1,
			Position = UDim2.new(1, -55, 0, 0),
			Size = UDim2.fromOffset(55, 18),
			Font = Enum.Font.Code,
			Text = "0",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			TextXAlignment = Enum.TextXAlignment.Right
		})
		
		local SliderFrame = self:CreateInstance("Frame", Holder, {
			BackgroundColor3 = Color3.fromRGB(25, 25, 25),
			BorderColor3 = Color3.fromRGB(40, 40, 40),
			BorderSizePixel = 1,
			Position = UDim2.fromOffset(0, 22),
			Size = UDim2.new(1, 0, 0, 14)
		})
		
		self:CreateInstance("UICorner", SliderFrame, {
			CornerRadius = UDim.new(0, 4)
		})
		
		local Fill = self:CreateInstance("Frame", SliderFrame, {
			BackgroundColor3 = Color3.fromRGB(125, 85, 255),
			BorderSizePixel = 0,
			Size = UDim2.fromScale(0, 1)
		})
		
		self:CreateInstance("UICorner", Fill, {
			CornerRadius = UDim.new(0, 4)
		})
		
		Config.Min = Config.Min or 0
		Config.Max = Config.Max or 100
		Config.Value = Config.Default or Config.Min
		Config.Increment = Config.Increment or 1
		Config.Rounding = Config.Rounding or 0
		Config.Prefix = Config.Prefix or ""
		Config.Suffix = Config.Suffix or ""
		Config.Callback = Config.Callback or NullFunction
		
		local function FormatValue(Value)
			local Rounded = Config.Rounding == 0 and math.floor(Value) or tonumber(string.format("%." .. Config.Rounding .. "f", Value))
			return Config.Prefix .. tostring(Rounded) .. Config.Suffix
		end
		
		local function UpdateSlider(Value)
			Value = math.clamp(Value, Config.Min, Config.Max)
			Value = math.floor(Value / Config.Increment + 0.5) * Config.Increment
			if Config.Rounding > 0 then
				Value = tonumber(string.format("%." .. Config.Rounding .. "f", Value))
			end
			Config.Value = Value
			local Percent = (Value - Config.Min) / (Config.Max - Config.Min)
			Fill.Size = UDim2.fromScale(Percent, 1)
			ValueLabel.Text = FormatValue(Value)
			if not Config.Disabled then
				Config.Callback(Value)
			end
		end
		
		local Dragging = false
		
		SliderFrame.InputBegan:Connect(function(Input)
			if Config.Disabled then return end
			if Input.UserInputType == Enum.UserInputType.MouseButton1 or Input.UserInputType == Enum.UserInputType.Touch then
				Dragging = true
				local RelativeX = math.clamp((Input.Position.X - SliderFrame.AbsolutePosition.X) / SliderFrame.AbsoluteSize.X, 0, 1)
				local Value = Config.Min + (Config.Max - Config.Min) * RelativeX
				UpdateSlider(Value)
			end
		end)
		
		UserInputService.InputEnded:Connect(function(Input)
			if Input.UserInputType == Enum.UserInputType.MouseButton1 or Input.UserInputType == Enum.UserInputType.Touch then
				Dragging = false
			end
		end)
		
		UserInputService.InputChanged:Connect(function(Input)
			if Dragging and (Input.UserInputType == Enum.UserInputType.MouseMovement or Input.UserInputType == Enum.UserInputType.Touch) then
				local RelativeX = math.clamp((Input.Position.X - SliderFrame.AbsolutePosition.X) / SliderFrame.AbsoluteSize.X, 0, 1)
				local Value = Config.Min + (Config.Max - Config.Min) * RelativeX
				UpdateSlider(Value)
			end
		end)
		
		function Config:SetValue(Value)
			UpdateSlider(Value)
			return Config
		end
		
		function Config:SetDisabled(Disabled)
			Config.Disabled = Disabled
			return Config
		end
		
		UpdateSlider(Config.Value)
		
		if Config.Tooltip then
			ImGui:AddTooltip(Holder, Config.Tooltip)
		end
		
		return Config
	end
	
	function ContainerClass:AddInput(Config)
		Config = Config or {}
		
		local Holder = self:CreateInstance("Frame", Frame, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 40)
		})
		
		local Label = self:CreateInstance("TextLabel", Holder, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 18),
			Font = Enum.Font.Code,
			Text = Config.Text or "Input",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			TextTransparency = 0.4,
			TextXAlignment = Enum.TextXAlignment.Left
		})
		
		local InputBox = self:CreateInstance("TextBox", Holder, {
			BackgroundColor3 = Color3.fromRGB(25, 25, 25),
			BorderColor3 = Color3.fromRGB(40, 40, 40),
			BorderSizePixel = 1,
			Position = UDim2.fromOffset(0, 22),
			Size = UDim2.new(1, 0, 0, 24),
			Font = Enum.Font.Code,
			Text = Config.Default or "",
			PlaceholderText = Config.Placeholder or "Type here...",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			ClearTextOnFocus = Config.ClearTextOnFocus ~= false
		})
		
		self:CreateInstance("UICorner", InputBox, {
			CornerRadius = UDim.new(0, 4)
		})
		
		local Padding = self:CreateInstance("UIPadding", InputBox, {
			PaddingLeft = UDim.new(0, 6),
			PaddingRight = UDim.new(0, 6)
		})
		
		Config.Value = Config.Default or ""
		Config.Callback = Config.Callback or NullFunction
		
		InputBox.FocusLost:Connect(function(EnterPressed)
			local Value = InputBox.Text
			if Config.Numeric then
				Value = tonumber(Value) or Config.Value
				InputBox.Text = tostring(Value)
			end
			Config.Value = Value
			if not Config.Finished or EnterPressed then
				Config.Callback(Value, EnterPressed)
			end
		end)
		
		function Config:SetValue(Value)
			InputBox.Text = tostring(Value)
			Config.Value = Value
			return Config
		end
		
		if Config.Tooltip then
			ImGui:AddTooltip(Holder, Config.Tooltip)
		end
		
		return Config
	end
	
	function ContainerClass:AddDropdown(Config)
		Config = Config or {}
		
		local Holder = self:CreateInstance("Frame", Frame, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 40),
			ClipsDescendants = false
		})
		
		local Label = self:CreateInstance("TextLabel", Holder, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 18),
			Font = Enum.Font.Code,
			Text = Config.Text or "Dropdown",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			TextTransparency = 0.4,
			TextXAlignment = Enum.TextXAlignment.Left
		})
		
		local DropdownButton = self:CreateInstance("TextButton", Holder, {
			BackgroundColor3 = Color3.fromRGB(35, 35, 35),
			BorderColor3 = Color3.fromRGB(40, 40, 40),
			BorderSizePixel = 1,
			Position = UDim2.fromOffset(0, 22),
			Size = UDim2.new(1, 0, 0, 24),
			Font = Enum.Font.Code,
			Text = "Select...",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			TextTransparency = 0.4
		})
		
		self:CreateInstance("UICorner", DropdownButton, {
			CornerRadius = UDim.new(0, 4)
		})
		
		local DropdownList = self:CreateInstance("Frame", Holder, {
			BackgroundColor3 = Color3.fromRGB(30, 30, 30),
			BorderColor3 = Color3.fromRGB(40, 40, 40),
			BorderSizePixel = 1,
			Position = UDim2.fromOffset(0, 48),
			Size = UDim2.new(1, 0, 0, 0),
			Visible = false,
			ZIndex = 100
		})
		
		self:CreateInstance("UICorner", DropdownList, {
			CornerRadius = UDim.new(0, 4)
		})
		
		local ScrollingFrame = self:CreateInstance("ScrollingFrame", DropdownList, {
			BackgroundTransparency = 1,
			BorderSizePixel = 0,
			Size = UDim2.fromScale(1, 1),
			CanvasSize = UDim2.fromScale(1, 0),
			ScrollBarThickness = 4
		})
		
		local ListLayout = self:CreateInstance("UIListLayout", ScrollingFrame, {
			SortOrder = Enum.SortOrder.LayoutOrder
		})
		
		Config.Values = Config.Values or {}
		Config.Value = Config.Default or ""
		Config.Callback = Config.Callback or NullFunction
		Config.Multi = Config.Multi or false
		Config.SelectedValues = {}
		
		local function UpdateDropdown()
			if Config.Multi then
				local Selected = {}
				for Value, _ in pairs(Config.SelectedValues) do
					table.insert(Selected, Value)
				end
				DropdownButton.Text = #Selected > 0 and table.concat(Selected, ", ") or "Select..."
			else
				DropdownButton.Text = Config.Value ~= "" and Config.Value or "Select..."
			end
		end
		
		local function CreateOption(Value)
			local Option = self:CreateInstance("TextButton", ScrollingFrame, {
				BackgroundColor3 = Color3.fromRGB(35, 35, 35),
				BorderSizePixel = 0,
				Size = UDim2.new(1, 0, 0, 24),
				Font = Enum.Font.Code,
				Text = Value,
				TextColor3 = Color3.fromRGB(255, 255, 255),
				TextSize = 12
			})
			
			Option.Activated:Connect(function()
				if Config.Multi then
					Config.SelectedValues[Value] = not Config.SelectedValues[Value] or nil
					Option.BackgroundColor3 = Config.SelectedValues[Value] and Color3.fromRGB(55, 55, 55) or Color3.fromRGB(35, 35, 35)
				else
					Config.Value = Value
					DropdownList.Visible = false
				end
				UpdateDropdown()
				Config.Callback(Config.Multi and Config.SelectedValues or Config.Value)
			end)
			
			ImGui:ApplyAnimations(Option, "Buttons")
		end
		
		DropdownButton.Activated:Connect(function()
			DropdownList.Visible = not DropdownList.Visible
		end)
		
		function Config:SetValues(Values)
			Config.Values = Values
			for _, Child in ipairs(ScrollingFrame:GetChildren()) do
				if Child:IsA("TextButton") then
					Child:Destroy()
				end
			end
			for _, Value in ipairs(Values) do
				CreateOption(Value)
			end
			ScrollingFrame.CanvasSize = UDim2.fromOffset(0, ListLayout.AbsoluteContentSize.Y)
			DropdownList.Size = UDim2.new(1, 0, 0, math.min(120, ListLayout.AbsoluteContentSize.Y))
			return Config
		end
		
		function Config:SetValue(Value)
			Config.Value = Value
			UpdateDropdown()
			return Config
		end
		
		Config:SetValues(Config.Values)
		UpdateDropdown()
		ImGui:ApplyAnimations(DropdownButton, "Buttons")
		
		if Config.Tooltip then
			ImGui:AddTooltip(Holder, Config.Tooltip)
		end
		
		return Config
	end
	
	function ContainerClass:AddGroupbox(Config)
		Config = Config or {}
		
		local Groupbox = self:CreateInstance("Frame", Frame, {
			BackgroundColor3 = Color3.fromRGB(20, 20, 20),
			BorderColor3 = Color3.fromRGB(40, 40, 40),
			BorderSizePixel = 1,
			Size = UDim2.new(1, 0, 0, 0),
			AutomaticSize = Enum.AutomaticSize.Y
		})
		
		self:CreateInstance("UICorner", Groupbox, {
			CornerRadius = UDim.new(0, 4)
		})
		
		local Header = self:CreateInstance("Frame", Groupbox, {
			BackgroundColor3 = Color3.fromRGB(25, 25, 25),
			BorderSizePixel = 0,
			Size = UDim2.new(1, 0, 0, 26)
		})
		
		self:CreateInstance("UICorner", Header, {
			CornerRadius = UDim.new(0, 4)
		})
		
		local Title = self:CreateInstance("TextLabel", Header, {
			BackgroundTransparency = 1,
			Position = UDim2.fromOffset(8, 0),
			Size = UDim2.new(1, -40, 1, 0),
			Font = Enum.Font.Code,
			Text = Config.Title or "Groupbox",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 14,
			TextXAlignment = Enum.TextXAlignment.Left
		})
		
		local ToggleButton = self:CreateInstance("TextButton", Header, {
			BackgroundTransparency = 1,
			Position = UDim2.new(1, -26, 0, 0),
			Size = UDim2.fromOffset(26, 26),
			Font = Enum.Font.Code,
			Text = Config.Open ~= false and "−" or "+",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 18
		})
		
		local Container = self:CreateInstance("Frame", Groupbox, {
			BackgroundTransparency = 1,
			Position = UDim2.fromOffset(0, 30),
			Size = UDim2.new(1, 0, 0, 0),
			AutomaticSize = Enum.AutomaticSize.Y,
			Visible = Config.Open ~= false
		})
		
		self:CreateInstance("UIListLayout", Container, {
			Padding = UDim.new(0, 4)
		})
		
		self:CreateInstance("UIPadding", Container, {
			PaddingLeft = UDim.new(0, 8),
			PaddingRight = UDim.new(0, 8),
			PaddingTop = UDim.new(0, 4),
			PaddingBottom = UDim.new(0, 8)
		})
		
		Config.Open = Config.Open ~= false
		
		ToggleButton.Activated:Connect(function()
			Config.Open = not Config.Open
			Container.Visible = Config.Open
			ToggleButton.Text = Config.Open and "−" or "+"
		end)
		
		local GroupboxClass = ImGui:ContainerClass(Container, Config, Window)
		return GroupboxClass
	end
	
	return ContainerClass
end

function ImGui:CreateWindow(WindowConfig)
	WindowConfig = WindowConfig or {}
	
	local DefaultSize = ImGui.IsMobile and UDim2.fromOffset(340, 480) or UDim2.fromOffset(500, 600)
	WindowConfig.Size = WindowConfig.Size or DefaultSize
	WindowConfig.Title = WindowConfig.Title or "ImGui Window"
	
	local Window = self:CreateInstance("Frame", ImGui.ScreenGui, {
		BackgroundColor3 = Color3.fromRGB(15, 15, 15),
		BorderColor3 = Color3.fromRGB(40, 40, 40),
		BorderSizePixel = 1,
		Position = WindowConfig.Position or UDim2.fromOffset(50, 50),
		Size = WindowConfig.Size
	})
	
	self:CreateInstance("UICorner", Window, {
		CornerRadius = UDim.new(0, 6)
	})
	
	local TitleBar = self:CreateInstance("Frame", Window, {
		BackgroundColor3 = Color3.fromRGB(20, 20, 20),
		BorderSizePixel = 0,
		Size = UDim2.new(1, 0, 0, 30)
	})
	
	self:CreateInstance("UICorner", TitleBar, {
		CornerRadius = UDim.new(0, 6)
	})
	
	local Title = self:CreateInstance("TextLabel", TitleBar, {
		BackgroundTransparency = 1,
		Position = UDim2.fromOffset(10, 0),
		Size = UDim2.new(1, -20, 1, 0),
		Font = Enum.Font.GothamBold,
		Text = WindowConfig.Title,
		TextColor3 = Color3.fromRGB(255, 255, 255),
		TextSize = 14,
		TextXAlignment = Enum.TextXAlignment.Left
	})
	
	local CloseButton = self:CreateInstance("TextButton", TitleBar, {
		BackgroundTransparency = 1,
		Position = UDim2.new(1, -28, 0, 0),
		Size = UDim2.fromOffset(28, 28),
		Font = Enum.Font.Code,
		Text = "×",
		TextColor3 = Color3.fromRGB(255, 255, 255),
		TextSize = 18
	})
	
	CloseButton.Activated:Connect(function()
		Window.Visible = false
	end)
	
	local TabBar = self:CreateInstance("Frame", Window, {
		BackgroundColor3 = Color3.fromRGB(18, 18, 18),
		BorderSizePixel = 0,
		Position = UDim2.fromOffset(0, 30),
		Size = UDim2.new(1, 0, 0, 32)
	})
	
	self:CreateInstance("UIListLayout", TabBar, {
		FillDirection = Enum.FillDirection.Horizontal,
		Padding = UDim.new(0, 4)
	})
	
	self:CreateInstance("UIPadding", TabBar, {
		PaddingLeft = UDim.new(0, 8)
	})
	
	local ContentFrame = self:CreateInstance("Frame", Window, {
		BackgroundTransparency = 1,
		Position = UDim2.fromOffset(0, 62),
		Size = UDim2.new(1, 0, 1, -62)
	})
	
	local ContentScroll = self:CreateInstance("ScrollingFrame", ContentFrame, {
		BackgroundTransparency = 1,
		BorderSizePixel = 0,
		Size = UDim2.fromScale(1, 1),
		CanvasSize = UDim2.fromScale(1, 0),
		ScrollBarThickness = 6,
		AutomaticCanvasSize = Enum.AutomaticSize.Y
	})
	
	self:CreateInstance("UIListLayout", ContentScroll, {
		Padding = UDim.new(0, 8)
	})
	
	self:CreateInstance("UIPadding", ContentScroll, {
		PaddingLeft = UDim.new(0, 10),
		PaddingRight = UDim.new(0, 10),
		PaddingTop = UDim.new(0, 10),
		PaddingBottom = UDim.new(0, 10)
	})
	
	WindowConfig.Tabs = {}
	WindowConfig.ActiveTab = nil
	
	function WindowConfig:CreateTab(Config)
		Config = Config or {}
		
		local TabButton = ImGui:CreateInstance("TextButton", TabBar, {
			BackgroundColor3 = Color3.fromRGB(25, 25, 25),
			BorderSizePixel = 0,
			Size = UDim2.new(0, ImGui.IsMobile and 80 or 100, 1, 0),
			Font = Enum.Font.Code,
			Text = Config.Name or "Tab",
			TextColor3 = Color3.fromRGB(255, 255, 255),
			TextSize = 13,
			TextTransparency = 0.5
		})
		
		ImGui:CreateInstance("UICorner", TabButton, {
			CornerRadius = UDim.new(0, 4)
		})
		
		local TabContent = ImGui:CreateInstance("Frame", ContentScroll, {
			BackgroundTransparency = 1,
			Size = UDim2.new(1, 0, 0, 0),
			AutomaticSize = Enum.AutomaticSize.Y,
			Visible = false
		})
		
		ImGui:CreateInstance("UIListLayout", TabContent, {
			Padding = UDim.new(0, 8)
		})
		
		Config.Button = TabButton
		Config.Content = TabContent
		Config.Tab = self
		
		TabButton.Activated:Connect(function()
			for _, Tab in pairs(WindowConfig.Tabs) do
				Tab.Content.Visible = false
				Tab.Button.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
				ImGui:Tween(Tab.Button, { TextTransparency = 0.5 })
			end
			
			TabContent.Visible = true
			TabButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
			ImGui:Tween(TabButton, { TextTransparency = 0 })
			WindowConfig.ActiveTab = Config
		end)
		
		table.insert(WindowConfig.Tabs, Config)
		
		if #WindowConfig.Tabs == 1 or Config.Visible then
			TabButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
			TabContent.Visible = true
			ImGui:Tween(TabButton, { TextTransparency = 0 })
			WindowConfig.ActiveTab = Config
		end
		
		ImGui:ApplyAnimations(TabButton, "Tabs")
		
		local TabClass = ImGui:ContainerClass(TabContent, Config, Window)
		return TabClass
	end
	
	function WindowConfig:SetTitle(Text)
		Title.Text = Text
		return self
	end
	
	function WindowConfig:Center()
		Window.Position = UDim2.fromScale(0.5, 0.5)
		Window.AnchorPoint = Vector2.new(0.5, 0.5)
		return self
	end
	
	ImGui:ApplyDraggable(TitleBar)
	ImGui.Windows[Window] = WindowConfig
	
	return WindowConfig
end

ImGui.ThemeManager = {
	Themes = {},
	CurrentTheme = "Default"
}

function ImGui.ThemeManager:CreateTheme(ThemeData)
	self.Themes[ThemeData.Name] = ThemeData
	return ThemeData
end

function ImGui.ThemeManager:ApplyTheme(ThemeName)
	local Theme = self.Themes[ThemeName]
	if Theme then
		self.CurrentTheme = ThemeName
		print("Theme applied:", ThemeName)
	end
	return Theme
end

function ImGui.ThemeManager:GetThemeList()
	local List = {}
	for Name, _ in pairs(self.Themes) do
		table.insert(List, Name)
	end
	return List
end

ImGui.ThemeManager:CreateTheme({
	Name = "Default",
	BackgroundColor = Color3.fromRGB(15, 15, 15),
	MainColor = Color3.fromRGB(25, 25, 25),
	AccentColor = Color3.fromRGB(125, 85, 255)
})

ImGui.ThemeManager:CreateTheme({
	Name = "Dark",
	BackgroundColor = Color3.fromRGB(10, 10, 10),
	MainColor = Color3.fromRGB(20, 20, 20),
	AccentColor = Color3.fromRGB(100, 100, 255)
})

ImGui.ThemeManager:CreateTheme({
	Name = "Light",
	BackgroundColor = Color3.fromRGB(240, 240, 240),
	MainColor = Color3.fromRGB(255, 255, 255),
	AccentColor = Color3.fromRGB(100, 150, 255)
})

ImGui.SaveManager = {
	SaveFolder = "ImGuiSaves",
	SaveFile = "config.json"
}

function ImGui.SaveManager:Save(Data)
	if not writefile then return false end
	if not isfolder(self.SaveFolder) then makefolder(self.SaveFolder) end
	writefile(self.SaveFolder .. "/" .. self.SaveFile, HttpService:JSONEncode(Data))
	return true
end

function ImGui.SaveManager:Load()
	if not readfile or not isfile(self.SaveFolder .. "/" .. self.SaveFile) then return nil end
	return HttpService:JSONDecode(readfile(self.SaveFolder .. "/" .. self.SaveFile))
end

local GuiParent = IsStudio and PlayerGui or CoreGui
ImGui.ScreenGui = ImGui:CreateInstance("ScreenGui", GuiParent, {
	DisplayOrder = 9999,
	ResetOnSpawn = false,
	IgnoreGuiInset = true
})

return ImGui
